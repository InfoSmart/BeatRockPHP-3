<?php####################################################### 					 BeatRock				   	   ######################################################### Framework avanzado de procesamiento para PHP.   ######################################################### InfoSmart © 2012 Todos los derechos reservados. #### http://www.infosmart.mx/						   ######################################################### http://beatrock.infosmart.mx/				   #######################################################$page['id'] = 'step2';require 'Init.php';	file_put_contents('./SECURE', 'SECURE - ' . IP . ' - ' . URL);$_SESSION['install']['secure'] = true;$step['mysql_host'] = 'localhost';$step['mysql_name'] = 'beatrock';$step['mysql_port'] = '3306';$step['memcache_port'] 	= 11211;$step['site_path'] 		= str_ireplace('/Setup/step2.php', '', URL);$step['site_resources'] 	= $step['site_path'] . '/resources/beatrock';$step['site_resources_sys'] = $step['site_path'] . '/resources/system';$step['security_hash'] = Random(80, true, true, true);$step['security_test'] = Encrypte('BeatRock-InfoSmart-@', 4, $step['security_hash']);$page['name'] = 'Configuración Maestra';require 'Header.php';?><div class="pre">	<section class="left">		<h2>Configuremos BeatRock</h2>		<cite>Precisamos de un archivo de configuración para continuar.</cite>		<p>			¡Aquí vamos! BeatRock por ahora solo es compatible con servidores de base de datos "<b>MySQL</b>" y necesitamos que proporciones los datos para realizar una conexión y crear la base de datos.		</p>		<p>			Igualmente aquí puedes configurar otros aspectos como el uso de un servidor <a href="http://memcached.org/" target="_blank">Memcached</a>, el reporte de errores, la seguridad y la carga media limite del servidor.		</p>		<p>			Toma en cuenta que...		</p>		<ul>			<li>La base de datos esta escrita en ingles.</li>			<li>Puede haber problemas con codificaciones fuera de "ISO-8859".</li>			<li>BeatRock creará la base de datos automáticamente.</li>		</ul>	</section>	<figure class="right">		<img src="<?=RESOURCES_INS?>/systemv2/setup/images/<?=$page['id']?>.png" />	</figure></div><div class="box-error">	Por favor resuelve los siguientes problemas:	<div id="errors"></div></div><div class="content">		<form id="process-form">		<section>			<h2>Base de datos (MySQL)</h2>			<input type="hidden" name="mysql_repair" value="false" />			<div class="c1">				<p>					<label for="mysql_host">Host:</label>					<input type="text" name="mysql_host" id="mysql_host" placeholder="localhost" value="<?=$step['mysql_host']?>" required autofocus autocomplete="off" />										<span>Host a donde se realizará la conexión al servidor MySQL.</span>				</p>				<p>					<label for="mysql_port">Puerto:</label>					<input type="number" name="mysql_port" id="mysql_port" placeholder="3306" value="<?=$step['mysql_port']?>" required autocomplete="off" />										<span>Puerto a donde se realizará la conexión al servidor MySQL.</span>				</p>				<p>					<label for="mysql_name">Nombre de la base de datos:</label>					<input type="text" name="mysql_name" id="mysql_name" value="<?=$step['mysql_name']?>" required autocomplete="off" />									<span>Nombre de la base de datos, tenga en cuenta que la instalación la creará automaticamente en caso de que no exista.</span>				</p>				<p>					<label>Reparación en error:</label>										<select name="mysql_repair_error" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>En caso de que se produzca un error relacionado con la base de datos, BeatRock reparará todas las tablas para intentar reparar el problema.</span>				</p>			</div>			<div class="c2">				<p>					<label for="mysql_user">Nombre de usuario:</label>					<input type="text" name="mysql_user" id="mysql_user" placeholder="root" value="<?=$step['mysql_user']?>" required autocomplete="off" />										<span>Nombre de usuario para la autenticación con el servidor MySQL.</span>				</p>				<p>					<label for="mysql_pass">Contraseña:</label>					<input type="password" name="mysql_pass" id="mysql_pass" value="<?=$step['mysql_pass']?>" required autocomplete="off" />									<span>Contraseña para la autenticación con el servidor MySQL.</span>				</p>				<p>					<label for="mysql_prefix">Prefijo de las tablas:</label>					<input type="text" name="mysql_prefix" id="mysql_prefix" value="<?=$step['mysql_prefix']?>" placeholder="myapp_" autocomplete="off" />										<span>Si mantendrá varias copias de BeatRock en una sola base de datos escriba un Prefijo para las tablas, esto evitará un conflicto entre ellas.</span>				</p>				<p>					<label>Optimización en error:</label>										<select name="mysql_optimize_error" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>En caso de que se produzca un error relacionado con la base de datos, BeatRock optimizará todas las tablas para intentar reparar el problema.</span>				</p>			</div>		</section>		<section>			<h2>Servidor "Memcached"</h2>			<div class="c1">				<p>					<label for="memcache_host">Host:</label>					<input type="text" name="memcache_host" id="memcache_host" placeholder="localhost" value="<?=$step['memcache_host']?>" autocomplete="off" />					<span>Si cuentas con un servidor Memcache, especifica el host a donde se realizará la conexión.</span>				</p>			</div>			<div class="c2">				<p>					<label for="memcache_port">Puerto:</label>					<input type="number" name="memcache_port" id="memcache_port" value="<?=$step['memcache_port']?>" autocomplete="off" />					<span>Si cuentas con un servidor Memcache, especifica el puerto a donde se realizará la conexión.</span>				</p>			</div>		</section>				<section>			<h2>Ubicación de la aplicación</h2>			<div class="c1">							<p>					<label>Zona de formato de fecha:</label>										<select name="site_country" class="btn" required>						<option value="Pacific/Midway">(GMT-11:00) Midway Island, Samoa</option>						<option value="America/Adak">(GMT-10:00) Hawaii-Aleutian</option>						<option value="Etc/GMT+10">(GMT-10:00) Hawaii</option>						<option value="Pacific/Marquesas">(GMT-09:30) Marquesas Islands</option>						<option value="Pacific/Gambier">(GMT-09:00) Gambier Islands</option>						<option value="America/Anchorage">(GMT-09:00) Alaska</option>						<option value="America/Ensenada">(GMT-08:00) Tijuana, Baja California</option>						<option value="Etc/GMT+8">(GMT-08:00) Pitcairn Islands</option>						<option value="America/Los_Angeles">(GMT-08:00) Pacific Time (US & Canada)</option>						<option value="America/Denver">(GMT-07:00) Mountain Time (US & Canada)</option>						<option value="America/Chihuahua">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option>						<option value="America/Dawson_Creek">(GMT-07:00) Arizona</option>						<option value="America/Belize">(GMT-06:00) Saskatchewan, Central America</option>						<option value="America/Mexico_City" selected>(GMT-06:00) Guadalajara, Mexico City, Monterrey</option>						<option value="Chile/EasterIsland">(GMT-06:00) Easter Island</option>						<option value="America/Chicago">(GMT-06:00) Central Time (US & Canada)</option>						<option value="America/New_York">(GMT-05:00) Eastern Time (US & Canada)</option>						<option value="America/Havana">(GMT-05:00) Cuba</option>						<option value="America/Bogota">(GMT-05:00) Bogota, Lima, Quito, Rio Branco</option>						<option value="America/Caracas">(GMT-04:30) Caracas</option>						<option value="America/Santiago">(GMT-04:00) Santiago</option>						<option value="America/La_Paz">(GMT-04:00) La Paz</option>						<option value="Atlantic/Stanley">(GMT-04:00) Faukland Islands</option>						<option value="America/Campo_Grande">(GMT-04:00) Brazil</option>						<option value="America/Goose_Bay">(GMT-04:00) Atlantic Time (Goose Bay)</option>						<option value="America/Glace_Bay">(GMT-04:00) Atlantic Time (Canada)</option>						<option value="America/St_Johns">(GMT-03:30) Newfoundland</option>						<option value="America/Araguaina">(GMT-03:00) UTC-3</option>						<option value="America/Montevideo">(GMT-03:00) Montevideo</option>						<option value="America/Miquelon">(GMT-03:00) Miquelon, St. Pierre</option>						<option value="America/Godthab">(GMT-03:00) Greenland</option>						<option value="America/Argentina/Buenos_Aires">(GMT-03:00) Buenos Aires</option>						<option value="America/Sao_Paulo">(GMT-03:00) Brasilia</option>						<option value="America/Noronha">(GMT-02:00) Mid-Atlantic</option>						<option value="Atlantic/Cape_Verde">(GMT-01:00) Cape Verde Is.</option>						<option value="Atlantic/Azores">(GMT-01:00) Azores</option>						<option value="Europe/Belfast">(GMT) Greenwich Mean Time : Belfast</option>						<option value="Europe/Dublin">(GMT) Greenwich Mean Time : Dublin</option>						<option value="Europe/Lisbon">(GMT) Greenwich Mean Time : Lisbon</option>						<option value="Europe/London">(GMT) Greenwich Mean Time : London</option>						<option value="Africa/Abidjan">(GMT) Monrovia, Reykjavik</option>						<option value="Europe/Amsterdam">(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna</option>						<option value="Europe/Belgrade">(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague</option>						<option value="Europe/Brussels">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option>						<option value="Africa/Algiers">(GMT+01:00) West Central Africa</option>						<option value="Africa/Windhoek">(GMT+01:00) Windhoek</option>						<option value="Asia/Beirut">(GMT+02:00) Beirut</option>						<option value="Africa/Cairo">(GMT+02:00) Cairo</option>						<option value="Asia/Gaza">(GMT+02:00) Gaza</option>						<option value="Africa/Blantyre">(GMT+02:00) Harare, Pretoria</option>						<option value="Asia/Jerusalem">(GMT+02:00) Jerusalem</option>						<option value="Europe/Minsk">(GMT+02:00) Minsk</option>						<option value="Asia/Damascus">(GMT+02:00) Syria</option>						<option value="Europe/Moscow">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option>						<option value="Africa/Addis_Ababa">(GMT+03:00) Nairobi</option>						<option value="Asia/Tehran">(GMT+03:30) Tehran</option>						<option value="Asia/Dubai">(GMT+04:00) Abu Dhabi, Muscat</option>						<option value="Asia/Yerevan">(GMT+04:00) Yerevan</option>						<option value="Asia/Kabul">(GMT+04:30) Kabul</option>						<option value="Asia/Yekaterinburg">(GMT+05:00) Ekaterinburg</option>						<option value="Asia/Tashkent">(GMT+05:00) Tashkent</option>						<option value="Asia/Kolkata">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option>						<option value="Asia/Katmandu">(GMT+05:45) Kathmandu</option>						<option value="Asia/Dhaka">(GMT+06:00) Astana, Dhaka</option>						<option value="Asia/Novosibirsk">(GMT+06:00) Novosibirsk</option>						<option value="Asia/Rangoon">(GMT+06:30) Yangon (Rangoon)</option>						<option value="Asia/Bangkok">(GMT+07:00) Bangkok, Hanoi, Jakarta</option>						<option value="Asia/Krasnoyarsk">(GMT+07:00) Krasnoyarsk</option>						<option value="Asia/Hong_Kong">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option>						<option value="Asia/Irkutsk">(GMT+08:00) Irkutsk, Ulaan Bataar</option>						<option value="Australia/Perth">(GMT+08:00) Perth</option>						<option value="Australia/Eucla">(GMT+08:45) Eucla</option>						<option value="Asia/Tokyo">(GMT+09:00) Osaka, Sapporo, Tokyo</option>						<option value="Asia/Seoul">(GMT+09:00) Seoul</option>						<option value="Asia/Yakutsk">(GMT+09:00) Yakutsk</option>						<option value="Australia/Adelaide">(GMT+09:30) Adelaide</option>						<option value="Australia/Darwin">(GMT+09:30) Darwin</option>						<option value="Australia/Brisbane">(GMT+10:00) Brisbane</option>						<option value="Australia/Hobart">(GMT+10:00) Hobart</option>						<option value="Asia/Vladivostok">(GMT+10:00) Vladivostok</option>						<option value="Australia/Lord_Howe">(GMT+10:30) Lord Howe Island</option>						<option value="Etc/GMT-11">(GMT+11:00) Solomon Is., New Caledonia</option>						<option value="Asia/Magadan">(GMT+11:00) Magadan</option>						<option value="Pacific/Norfolk">(GMT+11:30) Norfolk Island</option>						<option value="Asia/Anadyr">(GMT+12:00) Anadyr, Kamchatka</option>						<option value="Pacific/Auckland">(GMT+12:00) Auckland, Wellington</option>						<option value="Etc/GMT-12">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option>						<option value="Pacific/Chatham">(GMT+12:45) Chatham Islands</option>						<option value="Pacific/Tongatapu">(GMT+13:00) Nuku'alofa</option>						<option value="Pacific/Kiritimati">(GMT+14:00) Kiritimati</option>					</select>										<span>Seleccione la zona de formato de fecha usada para esta aplicación, la misma afecta a todas las funciones de tiempo de PHP.</span>				</p>				<p>					<label for="site_resources">Dirección de los Recursos de la aplicación:</label>					<input type="text" name="site_resources" id="site_resources" value="<?=$step['site_resources']?>" required autocomplete="off" />										<span>Escriba la dirección de los recursos (CSS, Imágenes, JavaScript) de la aplicación. Sin "http://" al principio ni "/" al final.</span>				</p>			</div>			<div class="c2">							<p>					<label for="site_path">Dirección de la aplicación:</label>					<input type="text" name="site_path" id="site_path" value="<?=$step['site_path']?>" required autocomplete="off" />										<span>Escriba la dirección para acceder a la aplicación sin "http://" al principio ni "/" al final.</span>				</p>											<p>					<label for="site_resources_sys">Dirección de los Recursos globales:</label>					<input type="text" name="site_resources_sys" id="site_resources_sys" value="<?=$step['site_resources_sys']?>" required autocomplete="off" />										<span>Escriba la dirección de los recursos globales (CSS, Imagenes, JavaScript) que serán usadas en todas sus aplicaciones. Sin "http://" al principio ni "/" al final.</span>				</p>			</div>		</section>				<section>			<h2>Seguridad</h2>			<div class="c1">							<p>					<label>Modo seguro:</label>										<select name="security_enabled" class="btn" required>						<option value="false">Desactivado</option>						<option value="true">Activado</option>					</select>										<span>El Modo seguro limpia las variables <b>"$_GET, $_POST, $_REQUEST y $_SESSION"</b> antes de poder usarlas/verlas en su aplicación. Puede ocacionar errores o resultados no deseados en aplicaciones avanzadas.</span>				</p>							<p>					<label>Sistema de codificación:</label>										<select name="security_level" id="security_level" class="btn" required>						<option value="0">Sin codificación</option>						<option value="1">Codificación MD5</option>						<option value="2">Codificación SHA1</option>						<option value="3">Codificación avanzada de SHA1 & SHA256</option>						<option value="4" selected>Codificación avanzada de SHA1 & SHA256 con MD5</option>						<option value="5">Codificación personalizada reversible</option>					</select>										<span>Seleccione el sistema de codificación usada para encriptar cadenas, por ejemplo las contraseñas.</span>				</p>			</div>			<div class="c2">							<p>					<label for="security_hash">Clave de codificación:</label>					<input type="text" name="security_hash" id="security_hash" value="<?=$step['security_hash']?>" required />										<span>La clave de codificación proporciona más seguridad a la hora de cifrar cadenas, sin ella las cadenas no serán cifradas correctamente así que <b>procure guardarlo en un lugar seguro</b>.</span>				</p>								<p>					<label>Prueba de codificación:</label>					<input type="text" id="security_test" value="<?=$step['security_test']?>" disabled readonly />										<span>Esta es la cadena "BeatRock-InfoSmart-@" encriptada con su configuración de codificación actual.</span>				</p>			</div>		</section>				<section>			<h2>Errores & Logs</h2>			<div class="c1">							<p>					<label>Mostrar los detalles de los errores:</label>										<select name="errors_details" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>En caso de que se produzca un error se mostrarán los detalles del mismo como el mensaje de error, el archivo donde se genero, la función responsable y probablemente la línea. <b>(Recomendado desactivar en fase de producción)</b></span>				</p>				<p>					<label>Ocultar errores de la base de datos:</label>										<select name="errors_hidden" class="btn" required>						<option value="false">Desactivado</option>						<option value="true">Activado</option>					</select>										<span>En caso de que se produzca un error con la base de datos BeatRock intentará solucionar el problema y continuar con la petición del usuario sin darle ningún aviso. <b>(Recomendado activar en fase de producción)</b></span>				</p>								<p>					<label>Reporte de errores:</label>										<select name="errors_report" class="btn" required>						<option value="E_ALL">Todos los errores, advertencias y alertas.</option>						<option value="E_ALL & ~E_NOTICE & ~E_DEPRECATED">Todos los errores y advertencias excepto alertas.</option>						<option value="E_ALL & ~E_NOTICE & ~E_WARNING & ~E_DEPRECATED" selected>Todos los errores excepto advertencias y alertas.</option>						<option value="E_ERROR & E_CORE_ERROR & E_COMPILE_ERROR & E_PARSE & E_RECOVERABLE_ERROR">Solo errores del núcleo PHP y fatales.</option>						<option value="~E_ALL">No mostrar errores (No recomendado)</option>					</select>										<span>Seleccione que errores desea que capture el reporte de errores de PHP.</span>				</p>			</div>			<div class="c2">							<p>					<label>Captura de Logs:</label>										<select name="logs_capture" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>Seleccione si desea capturar los Logs que genere BeatRock.</span>				</p>				<p>					<label>Guardado de Logs:</label>										<select name="logs_save" class="btn" required>						<option value="onerror">Solo en errores</option>						<option value="error">Solo errores</option>						<option value="warning">Solo alertas</option>						<option value="info">Solo informativas</option>						<option value="true">Todos</option>						<option value="false">Ninguno</option>					</select>										<span>Seleccione en que ocación BeatRock guardará los Logs generados.</span>				</p>				<p>					<label for="errors_email_to">Correo electrónico de reportes:</label>					<input type="email" name="errors_email_to" id="errors_email_to" value="" autocomplete="off" />										<span>En caso de que se produzca un error BeatRock enviará un correo electrónico de reporte a esta dirección.</span>				</p>			</div>				</section>				<section>			<h2>Servidor</h2>			<div class="c1">							<p>					<label>Compresión GZIP:</label>										<select name="server_gzip" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>Seleccione si desea usar la compresión GZIP. Activarla disminuye el tiempo de carga de su aplicación.</span>				</p>				<p>					<label>Solicitud de nombre Host/DNS:</label>										<select name="server_host" class="btn" required>						<option value="true">Activado</option>						<option value="false">Desactivado</option>					</select>										<span>Seleccione si desea activar la solicitud de Host/DNS del usuario, de esta manera podrá obtener más información acerca de el, sin embargo causa un retraso pequeño a la hora de ejecutar la aplicación.</span>				</p>			</div>			<div class="c2">				<p>					<label>Uso del protocolo seguro (HTTPS)</label>										<select name="server_ssl" class="btn" required>						<option value="null">Opcional</option>						<option value="true">Forzar uso</option>						<option value="false">Forzar NO uso</option>					</select>										<span>Seleccione de que manera desea usar el protocolo seguro SSL (HTTPS).</span>				</p>			</div>		</section>				<section>			<h2>Otros</h2>						<p>				<input type="checkbox" name="nodb" id="nodb" value="true" /> No crear la base de datos, solo el archivo de configuración. (Seleccionelo si ya ha creado la base de datos y las tablas)			</p>		</section>				<p>			<input type="submit" name="save" id="save_step2" value="Guardar configuración" title="Crear el archivo de configuración." class="ibtn" />			<input type="submit" name="show" id="show_step2" value="Mostrar configuración" title="Mostrar el texto del archivo de configuración." class="ibtn iblue" />		</p>	</form>	<section id="complete" hidden>		<h1>¡Todo salio fabuloso!</h1>		<p>			Hemos comprobado que todo sea correcto y ¡enhorabuena! hemos realizado la conexión con la base de datos y realizado los ajustes necesarios.		</p>		<div id="config_code" hidden>			<p>				Si estas viendo esto es por una de dos razones:			</p>			<ul>				<li>Has solicitado "mostrar el archivo de configuración" en vez de que BeatRock lo guardara automáticamente.</li>				<li>No hemos podido guardar el archivo de configuración.</li>			</ul>			<p>				Sea cual sea el caso te pedimos que copies y pegues el siguiente código en un archivo nuevo llamado <b>"Configuration.json"</b> en la carpeta <b>"/Kernel"</b>.			</p>			<center>				<textarea class="code config" readonly></textarea>				<p>					<a onclick="$('.config').select();">Seleccionar texto</a>				</p>			</center>		</div>		<div id="config_ok" hidden>			<p>				¿Te interesa saber que hicimos?			</p>			<ul>				<li>Creación de la base de datos.</li>				<li>Importación de los datos de la base de datos.</li>				<li>Creación del archivo de configuración en <b>"/Kernel/Configuration.json"</b>.</li>				<li>Creación de copia de seguridad del archivo de configuración en <b>"/Kernel/Configuration.Backup.json"</b>.</li>				<li>Creación de copia de seguridad de la clave secreta de encriptación en <b>"/Kernel/Secret_Hash"</b>.</li>			</ul>		</div>		<p>			<a href="./step3.php" class="ibtn iblue">Continuar</a>		</p>	</section></div>